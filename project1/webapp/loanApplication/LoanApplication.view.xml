<mvc:View controllerName="project1.loanapplication.LoanApplication"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:fb="sap.ui.comp.filterbar">

    <f:DynamicPage id="page_ManageLoanApplication" fitContent="true" headerExpanded="true" showFooter="{=!!${errors>/}.length}">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title id="titleId" text="Loan Application" />
                </f:heading>
            </f:DynamicPageTitle>
        </f:title>

        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <fb:FilterBar id="loanapplication" persistencyKey="myPersKey" useToolbar="false" search="advancedFilter" showClearOnFB="true" clear="clearAllFilters">
                    <fb:filterItems>
                        <fb:FilterItem name="Payroll Period" label="Payroll Period">
                            <fb:control>
                                <Input placeholder="Enter Payroll Period" value="{advancedFilterMdl>/payroll_period}" />
                            </fb:control>
                        </fb:FilterItem>

                        <fb:FilterItem name="Date" label="Date">
                            <fb:control>
                                <DatePicker value="{advancedFilterMdl>/date}" displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd" />
                            </fb:control>
                        </fb:FilterItem>

                        <fb:FilterItem name="Status" label="Status">
                            <fb:control>
                                <ComboBox items="{masterdataMdl>/status}" placeholder="Please Select Status" selectedKey="{advancedFilterMdl>/status}" selectionChange="onStatusChange">
                                    <core:Item key="{masterdataMdl>key}" text="{masterdataMdl>text}" />
                                </ComboBox>
                            </fb:control>
                        </fb:FilterItem>


                    </fb:filterItems>
                </fb:FilterBar>
            </f:DynamicPageHeader>
        </f:header>

        <f:content>
            <Panel>
                <OverflowToolbar>
                    <content>
                        <Label design="Bold" text="Items ({= ${manageLoanApplicationMdl>/}.length})" />
                        <ToolbarSpacer />
                        <Button id="btn_Create" type="Ghost" text="Create" press="onPressCreate" />
                        <!-- <ToolbarSeparator />
                        <Button icon="sap-icon://download" press="handleExport" tooltip="Download Excel" />
                        <ToolbarSeparator />
                        <OverflowToolbarButton type="Transparent" tooltip="Sort" icon="sap-icon://sort" press="handleSortButtonPressed"/>
                        <OverflowToolbarButton type="Transparent" tooltip="Group" icon="sap-icon://group-2" press="handleGroupButtonPressed"/>
                        <OverflowToolbarButton type="Transparent" icon="sap-icon://settings" tooltip="Settings" press="handlePersoButtonPressed"/> -->
                    </content>
                </OverflowToolbar>

                <ScrollContainer width="100%" vertical="true" focusable="true">
                    <Table id="tableManageLoanApplication" items="{manageLoanApplicationMdl>/}" mode="None" sticky="ColumnHeaders,HeaderToolbar" inset="false" class="sapUiSmallMarginTop" selectionChange="onPressSelectRow">
                        <columns>
                            <Column>
                                <Text text="Payroll Period" />
                            </Column>
                            <Column>
                                <Text text="Date" />
                            </Column>
                            <Column>
                                <Text text="Currency" />
                            </Column>
                            <Column>
                                <Text text="Disbursal Method" />
                            </Column>
                            <Column>
                                <Text text="Remarks" />
                            </Column>
                            <Column>
                                <Text text="Status" />
                            </Column>
                            <Column hAlign="End" width="7rem" />
                        </columns>
                        <items>
                            <ColumnListItem>
                                <cells>
                                    <Text text="{manageLoanApplicationMdl>payroll_period}" />
                                    <Text text="{ path: 'manageLoanApplicationMdl>date', formatter: '.formatter.formatDate' }" />
                                    <Text text="{manageLoanApplicationMdl>currency}" />
                                    <Text text="{manageLoanApplicationMdl>disbursal_method}" />
                                    <Text text="{manageLoanApplicationMdl>remarks}" />
                                    <ObjectStatus text="{ path: 'manageLoanApplicationMdl>status', formatter: '.formatter.getStatusText' }" state="{ path: 'manageLoanApplicationMdl>status', formatter: '.formatter.getStatusState' }" />
                                    <Button icon="sap-icon://show" type="Transparent" press="onPressView" tooltip="View Details" visible="{= !!${manageLoanApplicationMdl>hasDetails}}" />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>
                </ScrollContainer>
            </Panel>
        </f:content>

        <f:footer>
            <Toolbar>
                <Button id="btn_MngGeneralExpenseError" visible="{=!!${errors>/}.length}" icon="sap-icon://error" type="Negative" text="Error" press=".handleMessagePopoverPress" ariaHasPopup="Dialog" />
            </Toolbar>
        </f:footer>
    </f:DynamicPage>
</mvc:View>
