<mvc:View controllerName="project1.loanapplication.CreateLoanApplication"
  xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:form="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout">

    <f:DynamicPage id="pgLoanApplication" headerExpanded="false" fitContent="true" showFooter="{=!!${errors>/}.length}">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="Create Loan Application"/>
                </f:heading>
                <f:actions>
                    <Button id="btnSave" type="Emphasized" text="Save" press="onPressSave"/>
                    <Button id="btnClose" type="Transparent" text="Close" press="handleClose"/>
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>

        <f:content>
            <Panel backgroundDesign="Transparent">
                <form:SimpleForm id="sfCreateLoanApplication" layout="ColumnLayout" labelSpanXL="4" labelSpanL="4" labelSpanM="12" labelSpanS="12" columnsXL="3" columnsL="3" columnsM="2">
                    <form:content>
                        <Label text="Loan Batch Name"/>
                        <Input value="{loanApplicationMdl>/loan_batch_name}" placeholder="Please Enter Loan Batch Name"/>

                        <Label text="Payroll Period"/>
                        <ComboBox id="PeriodFil" placeholder="Please Select Payroll Period" items="{payrollPeriodMdl>/}" selectedKey="{empSearchReqModel>/payroll_period_id}" selectionChange="clearModel">
                            <core:ListItem key="{payrollPeriodMdl>id}" text="{payrollPeriodMdl>name}" />
                        </ComboBox>

                        <Label text="Date"/>
                        <DatePicker value="{loanApplicationMdl>/date}" valueFormat="yyyy-MM-dd" displayFormat="dd-MM-yyyy"/>

                        <!-- Currency -->
                        <Label text="Currency"/>
                        <ComboBox items="{loanApplicationMdl>/currency}" placeholder="Please Select Currency" selectedKey="{loanApplicationMdl>/currency}">
                            <core:Item key="{masterdataMdl>key}" text="{masterdataMdl>text}"/>
                        </ComboBox>

                        <Label text="Disbursal Method"/>
                        <ComboBox items="{masterdataMdl>/disbursal_method}" placeholder="Please Select Disbursal Method" selectedKey="{loanApplicationMdl>/disbursal_method}">
                            <core:Item key="{masterdataMdl>value}" text="{masterdataMdl>description}"/>
                        </ComboBox>


                        <Label text="Remarks"/>
                        <Input value="{loanApplicationMdl>/remarks}" placeholder="Enter remarks"/>

                        <Label text="Status"/>
                        <ComboBox items="{masterdataMdl>/status}" selectedKey="{loanApplicationMdl>/status}" placeholder="Please Select Status">
                            <core:ListItem key="{masterdataMdl>key}" text="{masterdataMdl>text}"/>
                        </ComboBox>
                    </form:content>
                </form:SimpleForm>


                <Table id="tableLoanApplication" items="{LoanModel>/}" mode="None" class="sapUiSmallMarginTop">
                    <headerToolbar>
                        <OverflowToolbar>
                            <content>
                                <ToolbarSpacer/>
                                <Button text="Add" id="btnAddRow" visible="true" press="OnPressAddRow" />
                            </content>
                        </OverflowToolbar>
                    </headerToolbar>
                    <columns>
                        <Column>
                            <Label text="Employee"/>
                        </Column>
                        <Column>
                            <Label text="Loan Code"/>
                        </Column>
                        <Column>
                            <Label text="Loan Amount"/>
                        </Column>
                        <Column>
                            <Label text="Disbursal Date"/>
                        </Column>
                        <Column>
                            <Label text="Repayment Start Date"/>
                        </Column>
                        <Column>
                            <Label text="Repayment Installments"/>
                        </Column>
                        <Column>
                            <Label text="Remarks"/>
                        </Column>
                    </columns>

                    <items>
                        <ColumnListItem>
                            <cells>
                                <!-- <Input id="empID" class="sapUiSmallMarginEnd" type="Text" value="{LoanModel>emp_code}" placeholder="Please Select Employee"/> -->
                                <ComboBox items="{masterdataMdl>/employee}" placeholder="Please Select Loan Code" selectedKey="{advancedFilterMdl>/employee}">
                                    <core:Item key="{masterdataMdl>value}" text="{masterdataMdl>description}"/>
                                </ComboBox>
                                <ComboBox items="{masterdataMdl>/loan_code}" placeholder="Please Select Loan Code" selectedKey="{advancedFilterMdl>/loan_code}">
                                    <core:Item key="{masterdataMdl>value}" text="{masterdataMdl>description}"/>
                                </ComboBox>
                                <Input value="{LoanModel>loan_amount}" type="Number"/>
                                <DatePicker value="{LoanModel>disbursal_date}" valueFormat="yyyy-MM-dd" displayFormat="dd-MM-yyyy" />
                                <DatePicker value="{LoanModel>repayment_start_date}" valueFormat="yyyy-MM-dd" displayFormat="dd-MM-yyyy" />
                                <Input value="{LoanModel>repayment_installment}" />
                                <Input value="{LoanModel>Remarks}"/>
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </Panel>
        </f:content>
        <f:footer>
            <Toolbar>
                <Button id="btn_GeneralExpenseError" class="sapUiTinyMarginTop" visible="{=!!${errors>/}.length}" icon="sap-icon://error" type="Negative" text="{i18n>organization_error}" press=".handleMessagePopoverPress" ariaHasPopup="Dialog" />
            </Toolbar>
        </f:footer>
    </f:DynamicPage>
</mvc:View>
